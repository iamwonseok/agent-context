# Agent-Context Development Repository
#
# This IS the agent-context source repository.
# - Modifying skills/, workflows/, tools/ IS allowed here
# - For design philosophy, see docs/ARCHITECTURE.md

# Agent-Context Project Rules

## IMPORTANT: This is a Development Repository

This repository is where agent-context is developed.
You CAN modify:
- `skills/` - Generic skill templates
- `workflows/` - Context-aware workflow definitions
- `tools/` - CLI tools
- `docs/convention/` - Coding conventions

## Design Philosophy

Read `docs/ARCHITECTURE.md` for the full rationale. Key principles:

1. **Simplicity Over Completeness** - Simple solutions that work > Complex solutions that might work better
2. **User Autonomy** - Warnings over blocking, provide `--force` escape hatches
3. **Feedback Over Enforcement** - Teach through clear feedback, not hard blocks
4. **Composability** - Thin skills, thick workflows
5. **State Through Artifacts** - Git + files, not databases or complex state machines

## Language Policy

| File Type | Language | Emoji | Unicode |
|-----------|----------|:-----:|:-------:|
| Executable (`*.sh`, `*.py`) | English only | Forbidden | Forbidden |
| Code comments | English only | Forbidden | Forbidden |
| Markdown (`*.md`) | Korean/English | Forbidden | Restricted |

**Unicode in Markdown:**
- Allowed: `->`, `-->`, `|`, `+`, `-`, standard markdown tables
- Forbidden: Emoji, checkmark symbols, star symbols

## Output Style

- Log format: `[OK]` pass, `[NG]` fail, `[!!]` warn, `[>>]` info
- No decorative Unicode in output

## Agent Behavior

### Session Start
1. Check `git status` and `git branch`
2. Ensure on feature branch (NOT main)
3. If on main, create/checkout feature branch before work

### Before Starting Work

| Task Type | Read First |
|-----------|------------|
| New feature | `workflows/solo/feature.md` |
| Bug fix | `workflows/solo/bugfix.md` |
| Hotfix | `workflows/solo/hotfix.md` |
| Sprint planning | `workflows/team/sprint.md` |
| Release | `workflows/team/release.md` |

### Workflow Logging (REQUIRED)

When you enter a workflow, you MUST log the execution:

```bash
# 1. Source logging library
source tools/agent/lib/logging.sh

# 2. Start log (user request)
seq_log_start "user's original request"

# 3. Begin workflow (path, trigger)
seq_log_workflow_begin "solo/feature" '"keyword" matched "feature"'
# Or for direct request:
seq_log_workflow_begin "solo/hotfix" 'User: "@workflows/solo/hotfix.md"'

# 4. For each skill:
seq_log_skill_begin "analyze"
seq_log_exec "command you ran" "OK" "0.1"  # or "NG" for failure
seq_log_skill_end "analyze" "OK"

# 5. End workflow
seq_log_workflow_end "solo/feature" "OK" "5/5 skills"

# 6. End log
seq_log_end "OK"
```

**Log Location:** `.context/logs/workflow_YYYY-MM-DD_HH-MM-SS.log`

### After Modifying Files
1. Run related tests if they exist
2. Fix any test failures before committing

### Before Committing
1. Review `git diff --staged`
2. Write commit message immediately (not later)

### Before Finishing
1. Ensure all tests pass
2. Create MR/PR, don't merge directly to main

### After Merge
- Delete merged feature branches from local
- Keep branches still in use (worktree, unmerged)

## Project Overview

Workflow + CI/CD template for agent-driven development.

### Directory Structure

```
agent-context/
├── docs/
│   └── ARCHITECTURE.md  # Design philosophy (Thin Skill / Thick Workflow)
├── skills/              # Generic skill templates
│   ├── analyze.md       # Understand the problem
│   ├── design.md        # Define the solution
│   ├── implement.md     # Execute the solution
│   ├── test.md          # Verify implementation
│   └── review.md        # Validate quality
├── workflows/           # Context-aware workflow definitions
│   ├── solo/            # Individual developer
│   │   ├── feature.md
│   │   ├── bugfix.md
│   │   └── hotfix.md
│   ├── team/            # Squad coordination
│   │   ├── sprint.md
│   │   └── release.md
│   └── project/         # Organization level
│       ├── quarter.md
│       └── roadmap.md
├── tools/               # CLI tools
│   ├── agent/           # Main CLI + logging
│   ├── pm/              # JIRA/GitLab API
│   └── worktree/        # Git worktree helpers
├── docs/                # Documentation
│   ├── ARCHITECTURE.md  # Design philosophy
│   └── convention/      # Coding conventions
└── tests/               # Tests
    └── workflows/       # Workflow integration tests
```

## Skills & Workflows

### Engineering Coordinate System

```
Y-Axis (Layer)              X-Axis (Timeline)
---------------------------------------------------------
PROJECT (Org)               Plan --> Execute --> Review
    |
TEAM (Squad)                Plan --> Execute --> Review
    |
SOLO (Dev)                  Plan --> Execute --> Review
```

### Thin Skill / Thick Workflow Pattern

| Concept | Role |
|---------|------|
| **Skill** | Generic template (interface) |
| **Workflow** | Context injection (implementation) |

**Skills (Thin):** 5 generic templates
- `analyze.md` - Understand the problem
- `design.md` - Define the solution
- `implement.md` - Execute the solution
- `test.md` - Verify implementation
- `review.md` - Validate quality

**Workflows (Thick):** Context-aware orchestration
- `solo/` - feature, bugfix, hotfix
- `team/` - sprint, release
- `project/` - quarter, roadmap

## Bash Scripts

### Structure
- Start with `#!/bin/bash`
- Use `set -e`
- Variables: SCRIPT_DIR, PROJECT_ROOT

### Test Output Format
```
==========================================
{Test Suite Name}
==========================================
Total: {N} | Passed: {N} | Failed: {N}
```

## Batch Operations

When you notice the same operation being repeated 3+ times, STOP and batch it.

| Task Type | Strategy |
|-----------|----------|
| Find files with pattern | Use grep/find ONCE |
| Replace in multiple files | Group by pattern type |
| Verify changes | Single test run at the end |
| Read multiple files | Parallel reads |

---
