# Agent-Context Development Repository
#
# This IS the agent-context source repository.
# - Modifying skills/, workflows/, tools/ IS allowed here
# - plan/ is the single source of truth for framework plans
# - For testing: use Docker-based test environment
#
# For design philosophy, see why.md

# Agent-Context Project Rules

## IMPORTANT: This is a Development Repository

This repository is where agent-context is developed.
Unlike user projects, you CAN modify:
- `skills/` - Atomic skills
- `workflows/` - Workflow definitions
- `tools/` - CLI tools
- `templates/` - User project templates

Single source of truth:
- `plan/` - Framework plans for this repository (SSoT)

### Plan Directory Convention
| Location | Purpose |
|----------|---------|
| `plan/` (this repo) | Framework plans (SSoT) |
| `.agent/plan/` (user project) | Framework plans (deployed from this repo `plan/`) |
| `plan/` (user project) | User's project-specific plans |

## Design Philosophy

Read `why.md` for the full rationale. Key principles:

1. **Simplicity Over Completeness** - Simple solutions that work > Complex solutions that might work better
2. **User Autonomy** - Warnings over blocking, provide `--force` escape hatches
3. **Feedback Over Enforcement** - Teach through clear feedback, not hard blocks
4. **Composability** - Small focused skills, workflows as compositions
5. **State Through Artifacts** - Git + files, not databases or complex state machines

## Avoiding Over-Engineering

### Before Adding Complexity, Ask:
- Has the simple solution failed multiple times?
- Are users consistently making the same mistake?
- Is the pain documented with real examples?
- Have simpler alternatives been tried?

### Complexity Budget (Max Lines)
| Component | Limit |
|-----------|-------|
| Single skill | 200 lines |
| Workflow | 100 lines |
| CLI command | 100 lines |
| Helper library | 300 lines |

### Patterns to Avoid
- Complex state machines (use simple flags instead)
- Hard blocking without `--force` option
- Custom DSLs (use standard YAML/Markdown)
- Deep nesting (max 2 levels)
- Implicit dependencies (be explicit)

### Enforcement Strategy
- **Phase 1 (2 weeks)**: Warnings only
- **Phase 2 (2 weeks)**: Soft enforcement (`--force` to override)
- **Phase 3 (ongoing)**: Hard enforcement where proven necessary

### When Implementing Features
1. Write SKILL.md documentation first
2. Implement minimal version (warnings only)
3. Gather real usage feedback
4. Add enforcement gradually
5. Always keep escape hatches

## Language Policy
- **Execution code and commit artifacts: English only**
  - Source code, scripts, config, and code comments MUST be in English
  - Variable/function/class names MUST be in English
  - Commit messages MUST be in English
- **Docs exception (this repo only)**: Korean is allowed in Markdown documents (`*.md`) in this repository
  - Rationale: Document-language exception is defined in `plan/agent-workflow-system-plan.md` (Quality Requirements)
  - This exception does NOT apply to executable code or code comments

## Output Style
- **No Korean characters in executable code or code comments**
- Korean is allowed only in `*.md` documents in this repo (see Language Policy)
- Unicode symbols allowed (arrows, box chars, block elements, math symbols)
  - Allowed: `‚Üí`, `‚îú`, `‚îî`, `‚îÇ`, `‚îÄ`, `‚ñà`, `‚ñë`, `√ó`, `¬±`
- No icon-style Unicode:
  - No checkmarks: use `[x]`, `[ ]` instead of `‚úì`, `‚úó`
  - No stars: use numbers instead of `‚òÖ`
  - No emoji: use `[PASS]`, `[FAIL]`, `[WARN]`, `[INFO]` instead of ‚ö†Ô∏è‚úÖüî¥

## Agent Behavior

### Session Start
1. Check `git status` and `git branch`
2. Ensure on feature branch (NOT main)
3. If on main, create/checkout feature branch before work

### Before Starting Work
| Task Type | Read First |
|-----------|------------|
| New feature | `workflows/developer/feature.md` |
| Bug fix | `workflows/developer/bug-fix.md` |
| Hotfix | `workflows/developer/hotfix.md` |
| Refactoring | `workflows/developer/refactor.md` |
| Large/complex task | `skills/plan/design-solution/SKILL.md` |

If the exact workflow file is unclear, look under:
- `workflows/developer/` (Developer)
- `workflows/manager/` (Manager)

### After Modifying Files
1. Run related tests if they exist
2. Check `skills/_tests/` for test scripts
3. Fix any test failures before committing

### Before Committing
1. Read `skills/integrate/commit-changes/SKILL.md` for message format
2. Review `git diff --staged`
3. Write commit message immediately (not later)

### Before Finishing
1. Read `skills/integrate/create-merge-request/SKILL.md`
2. Ensure all tests pass
3. Create MR/PR, don't merge directly to main

### After Merge
- Delete merged feature branches from local
- Keep branches still in use (worktree, unmerged)

### Concurrent Work
- For parallel work, prefer Detached Mode worktrees (see Hybrid Mode Guidance)

## Operational Invariants (Artifacts as State)
- `.context/` and `.worktrees/` are **state/log artifacts**, not permanent storage
  - After submission (MR/PR created), clean them up (archive/delete) per workflow
  - Prefer keeping logs in Issue/MR description (see Issue N/A policy)
- Keep the **main working directory clean** (no long-lived generated artifacts)

## Hybrid Mode Guidance (Git Strategy)
- Default: **Interactive Mode = branch workflow in current directory**
- For parallel/background work: **Detached Mode = worktree in `.worktrees/`**

## Issue N/A Policy
- If there is no Issue (N/A):
  - Create MR/PR as usual
  - Include `.context/` summary/logs in the MR/PR description **instead of uploading to an Issue**

## Human-only Decisions (Permissions Boundary)
- Decisions like **approval/merge** are `human_only` by default
  - The agent may prepare, summarize, and suggest actions, but should not execute final decisions unless explicitly authorized

## Project Overview
Workflow + CI/CD template for agent-driven development.

### Directory Structure
```
agent-context/                  # This repo = deployable unit
‚îú‚îÄ‚îÄ plan/                       # Framework plans (SSoT)
‚îú‚îÄ‚îÄ skills/                     # Atomic skills (building blocks)
‚îú‚îÄ‚îÄ workflows/                  # Workflow definitions (combinations)
‚îú‚îÄ‚îÄ tools/                      # CLI tools
‚îÇ   ‚îú‚îÄ‚îÄ agent/                  # Main CLI
‚îÇ   ‚îú‚îÄ‚îÄ pm/                     # JIRA/GitLab API
‚îÇ   ‚îî‚îÄ‚îÄ lint/                   # Code quality
‚îú‚îÄ‚îÄ templates/                  # User project templates
‚îÇ   ‚îî‚îÄ‚îÄ plan/                   # Project plan directory template
‚îú‚îÄ‚îÄ coding-convention/          # Language rule docs
‚îú‚îÄ‚îÄ setup.sh                    # Installation script
‚îî‚îÄ‚îÄ why.md                      # Design philosophy
```

### User Project Structure (After Setup)
```
user-project/
‚îú‚îÄ‚îÄ .agent/                     # Agent-context framework (installed)
‚îÇ   ‚îú‚îÄ‚îÄ plan/                   # Framework plans (from agent-context `plan/`)
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ plan/                       # User's project plans (from templates/plan/)
```

## Skills & Workflows

### Skills (`skills/`)
Organized into 5 categories:
- `analyze/` - Understand situation (parse-requirement, inspect-codebase, ...)
- `plan/` - Design approach (design-solution, breakdown-work, ...)
- `execute/` - Perform work (write-code, refactor-code, fix-defect, ...)
- `validate/` - Verify quality (run-tests, check-style, review-code, ...)
- `integrate/` - Deliver results (commit-changes, create-merge-request, ...)

### Workflows (`workflows/`)
Skill combinations for scenarios:
- `developer/feature.md` - Full feature development
- `developer/bug-fix.md` - Standard bug fix
- `developer/hotfix.md` - Emergency fix
- `developer/refactor.md` - Code refactoring
- `manager/*` - Manager workflows (approval, monitoring, initiative, ...)

### Quality Gates
| Gate | Criteria |
|------|----------|
| Lint | 0 violations |
| Test | All pass, ‚â•80% coverage |
| Review | 0 critical issues |

## Bash Scripts

### Structure
- Start with `#!/bin/bash`
- Use `set -e`
- Variables: SCRIPT_DIR, TEST_DIR, PROJECT_ROOT

### JUnit Pattern
- Source `junit_helper.sh`
- Use CHECK_RESULT global
- `check_*_rule()` with case statements
- Iterate pass/fail directories
- Call `junit_testsuite()` for XML

### Test Files
- Prefix: rule ID (e.g., `C-01-01_tab.c`)
- `pass/`: Should pass
- `fail/`: Should detect violation

### Output Format
```
==========================================
{Language} Coding Convention Test Summary
==========================================
Total: {N} | Passed: {N} | Failed: {N}
```

## CI/CD
- GitLab CI
- Nexus Registry for images
- JUnit XML as artifacts

## Rule ID Prefixes
- C: C-XX-XX
- Bash: Bash-XX-XX
- Make: Make-XX-XX
- Python: Py-XX-XX
- YAML: YAML-XX-XX
- Dockerfile: Docker-XX-XX
